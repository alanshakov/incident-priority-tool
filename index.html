<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Incident Priority Calculator</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1400px;
      margin: auto;
      background: #fff;
      padding: 20px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
    }
    .sticky-result {
      position: sticky;
      top: 0;
      padding: 20px;
      color: white;
      text-align: center;
      z-index: 10;
      transition: background 0.3s ease;
    }
    .priority {
      font-size: 2em;
      font-weight: bold;
    }
    .score {
      font-size: 1.2em;
      margin-bottom: 10px;
    }
    .button {
      background: rgba(0,0,0,0.1);
      color: #fff;
      border: 2px solid #fff;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 4px;
      font-weight: bold;
    }
    .checkbox-group label {
      display: block;
      margin-bottom: 6px;
    }
    .checkbox-group label.disabled {
      opacity: 0.5;
      pointer-events: none;
    }
    .checkbox-group input:disabled {
      cursor: not-allowed;
    }
    h2 {
      font-size: 1.2em;
      margin: 20px 0 10px;
    }
    details {
      margin-bottom: 10px;
    }
    summary {
      cursor: pointer;
      font-weight: bold;
    }
    .critical-option {
      background-color: #ffe6e6;
      border: 2px solid #ff6b6b;
      padding: 5px;
      border-radius: 4px;
      margin-bottom: 10px;
    }
    .critical-option label {
      font-weight: bold;
      color: #d63031;
    }
  </style>
</head>
<body>
  <div class="sticky-result" id="result">
    <div class="priority" id="priority">Priority: P5</div>
    <div class="score">Total Score: <span id="score">0</span></div>
    <button class="button" onclick="copyToClipboard()">Copy Incident Data</button>
  </div>

  <div class="container">
    <div>
      <h2>Audience Affected</h2>
      <div class="checkbox-group" id="audience">
        <div class="critical-option">
          <label><input type="checkbox" value="100" id="totalDowntime"> Total downtime</label>
        </div>
        <label><input type="checkbox" value="20"> All players (20)</label>
        <label><input type="checkbox" value="10"> 1 or more providers entirely (10)</label>
        <label><input type="checkbox" value="5"> B2B brand affected (5)</label>
        <label><input type="checkbox" value="8"> XL size brand affected (8)</label>
        <label><input type="checkbox" value="6"> L size brand affected (6)</label>
        <label><input type="checkbox" value="3"> M size brand affected (3)</label>
        <label><input type="checkbox" value="2"> S size brand affected (2)</label>
        <label><input type="checkbox" value="1"> XS size brand affected (1)</label>
        <label><input type="checkbox" value="6"> VIP-players (6)</label>
      </div>

      <h2>Brands by Size (B2B - <span style="text-decoration: underline;">underlined</span>)</h2>
      <details><summary>XL brands</summary><p><strong><u>ninecasino</u></strong>, <strong><u>betonred</u></strong>, <strong><u>bdmbet</u></strong></p></details>
      <details><summary>L brands</summary><p><strong><u>ninewin</u></strong>, vincispin, <strong><u>liraspin</u></strong>, <strong><u>kinghills</u></strong>, <strong><u>brunocasino</u></strong>, <strong><u>oscarspin</u></strong>, <strong><u>jokabet</u></strong>, <strong><u>spinmama</u></strong>, <strong><u>coolzino</u></strong></p></details>
      <details><summary>M brands</summary><p><strong><u>savaspin</u></strong>, <strong><u>b7casino</u></strong>, <strong><u>nyxbets</u></strong>, fridayroll, <strong><u>billionairespin</u></strong>, candyspinz, <strong><u>crystalroll</u></strong>, <strong><u>memocasino</u></strong>, vipzino, <strong><u>katanaspin</u></strong>, <strong><u>xtraspin</u></strong>, felixspin, <strong><u>jackpotraider</u></strong>, <strong><u>f7casino</u></strong>, <strong><u>r2pbet</u></strong>, highflybet, <strong><u>zumospin</u></strong>, <strong><u>betsixty</u></strong>, <strong><u>nomaspin</u></strong>, <strong><u>carlospin</u></strong>, winaura, <strong><u>wbetz</u></strong>, <strong><u>spinbuddha</u></strong>, <strong><u>gigaspinz</u></strong></p></details>
      <details><summary>S brands</summary><p>rockyspin, <strong><u>cryptoleo</u></strong>, lazybar, <strong><u>heyspin</u></strong>, capospin, romancasino, godofcoins, <strong><u>getslots</u></strong>, bettyspin, <strong><u>pinocasino</u></strong>, <strong><u>duxcasino</u></strong>, rolldorado, <strong><u>whitelabel_1</u></strong>, gambloria</p></details>
      <details><summary>XS brands</summary><p><strong><u>turbowinz</u></strong>, roulettino, <strong><u>blazingwildz</u></strong>, <strong><u>honeybetz</u></strong>, <strong><u>spinmacho</u></strong>, <strong><u>ivybet</u></strong>, <strong><u>corgibet</u></strong>, <strong><u>betgrouse</u></strong>, <strong><u>betonred-ng</u></strong>, playjonny, <strong><u>spingranny</u></strong>, <strong><u>piperspin</u></strong>, <strong><u>octocasino</u></strong>, <strong><u>heyspin.dk</u></strong>, morospin</p></details>
    </div>

    <div>
      <h2>Functionality Affected</h2>
      <div class="checkbox-group" id="functionality">
        <label><input type="checkbox" value="16"> Authorization (16)</label>
        <label><input type="checkbox" value="14"> Registration (14)</label>
        <label><input type="checkbox" value="12"> Deposit (12)</label>
        <label><input type="checkbox" value="10"> Withdrawal (10)</label>
        <label><input type="checkbox" value="14"> Bets/Winnings calculation (14)</label>
        <label><input type="checkbox" value="10"> Games don't work (10)</label>
        <label><input type="checkbox" value="6"> Live games don't work (6)</label>
        <label><input type="checkbox" value="2"> Freespins (2)</label>
        <label><input type="checkbox" value="4"> Promo/bonuses (4)</label>
      </div>

      <h2>Time Factors</h2>
      <div class="checkbox-group" id="time">
        <label><input type="checkbox" value="6"> Major tournament/event (6)</label>
        <label><input type="checkbox" value="4"> Prime time, 18–23h (4)</label>
        <label><input type="checkbox" value="3"> Weekend or holiday (3)</label>
        <label><input type="checkbox" value="2"> Working day (2)</label>
      </div>
    </div>
  </div>

  <script>
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    const priorityEl = document.getElementById('priority');
    const scoreEl = document.getElementById('score');
    const resultEl = document.getElementById('result');
    const totalDowntimeCheckbox = document.getElementById('totalDowntime');

    function calculate() {
      let score = 0;
      
      // Если выбран Total downtime, устанавливаем P1 приоритет
      if (totalDowntimeCheckbox.checked) {
        score = 100; // Максимальный вес для P1
        priorityEl.textContent = 'Priority: P1';
        updateBackground('P1');
      } else {
        // Обычный расчет
        checkboxes.forEach(cb => {
          if (cb.checked && cb !== totalDowntimeCheckbox) {
            score += parseInt(cb.value);
          }
        });

        let priority = 'P5';
        if (score >= 30) priority = 'P1';
        else if (score >= 20) priority = 'P2';
        else if (score >= 12) priority = 'P3';
        else if (score >= 6) priority = 'P4';

        priorityEl.textContent = `Priority: ${priority}`;
        updateBackground(priority);
      }
      
      scoreEl.textContent = score;
    }

    function updateBackground(priority) {
      const colors = {
        P1: '#8B0000',  // Темно-красный (критический)
        P2: '#FF8C00',  // Оранжевый
        P3: '#FFD700',  // Желтый
        P4: '#9ACD32',  // Зеленый
        P5: '#B0B0B0'   // Серый
      };
      resultEl.style.backgroundColor = colors[priority] || '#B0B0B0';
    }

    function toggleOtherCheckboxes() {
      const isDowntimeChecked = totalDowntimeCheckbox.checked;
      const otherCheckboxes = document.querySelectorAll('#audience input[type="checkbox"]:not(#totalDowntime)');
      const functionalityCheckboxes = document.querySelectorAll('#functionality input[type="checkbox"]');
      const timeCheckboxes = document.querySelectorAll('#time input[type="checkbox"]');
      
      // Блокируем/разблокируем другие чекбоксы
      [...otherCheckboxes, ...functionalityCheckboxes, ...timeCheckboxes].forEach(cb => {
        if (isDowntimeChecked) {
          cb.disabled = true;
          cb.checked = false;
          cb.parentElement.classList.add('disabled');
        } else {
          cb.disabled = false;
          cb.parentElement.classList.remove('disabled');
        }
      });
      
      calculate();
    }

    function copyToClipboard() {
      const selected = Array.from(checkboxes)
        .filter(cb => cb.checked)
        .map(cb => `- ${cb.parentElement.innerText}`)
        .join('\n');
      const text = `${priorityEl.textContent}\nScore: ${scoreEl.textContent}\nSelected:\n${selected}`;
      navigator.clipboard.writeText(text).then(() => {
        alert("Incident data copied to clipboard.");
      });
    }

    // Добавляем обработчик для Total downtime
    totalDowntimeCheckbox.addEventListener('change', toggleOtherCheckboxes);
    
    // Добавляем обработчики для остальных чекбоксов
    checkboxes.forEach(cb => {
      if (cb !== totalDowntimeCheckbox) {
        cb.addEventListener('change', calculate);
      }
    });
    
    calculate();
  </script>
</body>
</html>